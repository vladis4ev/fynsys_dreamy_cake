"use strict";function extend(t,e){var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t,t.superclass=e.prototype}function appendScript(t){var e=document.createElement("script");e.src=("https:"===document.location.protocol?"https":"http")+t,e.type="text/javascript",e.async="true";var i=document.getElementsByTagName("script")[0];return i.parentNode.insertBefore(e,i),e}function resizeGame(t){scaleToWindow(document.getElementById("mainContainer"))}function handleVisibilityChange(){if(isvisible){isvisible=!1,soundBt.bgSound&&(soundBt.bgSound.toggleMute=!0);var t=setTimeout(function(){PIXI.sound.muteAll(),clearTimeout(t)},50)}else isvisible=!0,soundBt?soundBt.iconON.visible&&(PIXI.sound.unmuteAll(),soundBt.bgSound&&(soundBt.bgSound.toggleMute=!1)):PIXI.sound.unmuteAll()}function hex2rgb(t){var e=[],i=parseInt(t,16);return PIXI.utils.hex2rgb(i,e),e[0]=255*e[0],e[1]=255*e[1],e[2]=255*e[2],e}function getPoligon(t){for(var e=[],i=t.length,s=0;s<i;s++)e.push(new PIXI.Point(t[s][0],t[s][1]));return e}function setPivotPoint(t,e){var i,s;switch(s=null===t.texture.trim?t:t.texture.trim,e){case"bottomCenter":i={x:s.x+s.width/2,y:s.y+s.height};break;default:i={x:s.x+s.width/2,y:s.y+s.height/2}}t.pivot.set(i.x,i.y),t.position.set(i.x,i.y)}function UniqueRandom(t,e){var i=this,s=[];this.rewriteArray=function(){for(var i=t;i<e+1;i++)s.push(i);return s},this.generNum=function(){var t=s.length,e=getRandomInt(1,t);return res=s[e-1],s.splice(e-1,1),res},this.getNum=function(){return 0==s.length&&(s=i.rewriteArray()),i.generNum()},this.rewriteArray()}function DefaultButton(t,e,i){var s;this.filter=new PIXI.filters.ColorMatrixFilter,s="sprite"===t.pluginName?t:new Sprite(resources[t[0]].textures[t[1]]),this.lastBt=s,s.buttonMode=!0,s.interactive=!0,s.texture.trim?(s.hitArea=new PIXI.Polygon(getPoligon(resources[t[0]].data.frames[t[1]].vertices)),setPivotPoint(s),this.relScale=Math.floor(stateWidth/s.texture.trim.width)/100):(s.anchor.set(.5,.5),e&&(s.position.set(e.x,e.y),"rotation"in e&&(s.rotation=e.rotation),"scaleX"in e&&(s.scale.x=e.scaleX)),this.relScale=Math.floor(stateWidth/s.width)/100);var n=PIXI.utils.isMobile;return n.phone||n.tablet?void 0!==i&&s.on("tap",i):(s.on("mousedown",this.onButtonHandler.bind(this)).on("touchstart",this.onButtonHandler.bind(this)).on("mouseup",this.onButtonHandler.bind(this)).on("touchend",this.onButtonHandler.bind(this)).on("mouseupoutside",this.onButtonHandler.bind(this)).on("touchendoutside",this.onButtonHandler.bind(this)).on("mouseover",this.onButtonHandler.bind(this)).on("mouseout",this.onButtonHandler.bind(this)),void 0!==i&&s.on("click",i)),s}function Game(){return this.cont=new Container,this.cont.interactiveChildren=!1,this.cont.visible=!1,this.catColor=["ffb3c9","ff7f43","00bbb9","ad6dee","8986ff","ffd823","97e773","00fff6","ff67f6","86e1ff"],this.catName=["shape","col","pr","gr","fr","sw","flower","cookie","candle","top"],this.shapeColor=["efe8d2","fea8ff","e8069b","ebf107","3cb450","1aa7f1","ffca08","ffc3a2","381400","d62722","b85c8d","b18362","8805c5","fff200","fc7d00","5e79ff","a1ffe8","eda57d","ffefad","f0c3ff"],this.decorBord=new PIXI.filters.OutlineFilter(3,10092441),this.decorBord.padding=stateWidth,this.countVoice=0,this.voice=null,this}function DecorPart(t,e){function i(t){resources.selectDecor.sound.play(),gameUI.cont.interactiveChildren=!1,soundBt.cont.interactiveChildren=!1,game.rouletteCont.interactiveChildren=!1,game.btContMenu.interactiveChildren=!1,game.btContDecor.interactiveChildren=!1,game.btOk.interactive=!1,game.btTrash.interactive=!1,game.lastDecor&&(game.lastDecor.filters=null),this.data=t.data,this.alpha=.75,this.dragging=!0,this.parent.setChildIndex(this,this.parent.children.length-1),this.filters=null}function s(e){if(e.target&&e.target.data){var s={x:e.target.x,y:e.target.y};s.x<stateWidth/2||s.x>stateWidth||s.y>stateHeight||s.y<0?(resources.removeDecorSnd.sound.play(),removeDecor(e.target)):(resources.putDecor.sound.play(),e.target.alpha=1,e.target.dragging=!1,e.target.data=null,e.target.filters=[game.decorBord],e.target.buttonMode||(e.target.hitArea=new PIXI.Polygon(getPoligon(resources.dataGame2.data.frames[t].vertices)),e.target.buttonMode=!0,e.target.on("mousedown",i).on("touchstart",i)),game.lastDecor=e.target,game.btContDecor.interactiveChildren||(s.y<stateHeight-(game.btContDecor.height+e.target.height/2)?(game.btContDecor.filters=null,game.btContDecor.alpha=1,game.btContDecor.interactiveChildren=!0):(game.btContDecor.filters=[game.btContDecor.darcFilter],game.btContDecor.alpha=.8))),gameUI.cont.interactiveChildren=!0,soundBt.cont.interactiveChildren=!0,game.rouletteCont.interactiveChildren=!0,game.btContMenu.interactiveChildren=!0,game.btOk.interactive=!0,game.btTrash.interactive=!0}}function n(t){if(this.dragging){var e=this.data.getLocalPosition(this.parent);this.x=e.x,this.y=e.y}}resources.selectDecor.sound.play(),game.lastDecor&&(game.lastDecor.filters=null);var a=new Sprite(game.texturs2[t]);game.decorCont.addChild(a),setPivotPoint(a);var o=e.data.global;return a.position.set(o.x,o.y),a.interactive=!0,a.data=e.data,a.alpha=.75,a.dragging=!0,a.on("mouseup",s).on("mouseupoutside",s).on("touchend",s).on("touchendoutside",s).on("mousemove",n).on("touchmove",n),this}function removeDecor(t){t.dragging=!1,t.data=null,t.filters=null,t.parent.removeChild(t),t=void 0,game.lastDecor=null,game.btContDecor.filters=[game.btContDecor.darcFilter],game.btContDecor.alpha=.8,game.btContDecor.interactiveChildren=!1}function GameUI(){return this.cont=new Container,this.cont.interactiveChildren=!1,this.cont.visible=!1,this.hotCont=new Container,this.hotCont.visible=!1,this.lastBt=null,this.cont.addChild(this.hotCont),this}function Share(){this.cont=new Container,this.cont.visible=!1,this.cont.interactiveChildren=!1;var t=new PIXI.Graphics;t.beginFill(0,.7),t.drawRect(0,0,stateWidth,stateHeight),t.endFill();var e="Поделиться",i="Сохранить\nизображение",s=40,n=30;"ru"!==this.determLang()&&(e="Share",i="Save image",s=60,n=50),this.progField1=new PIXI.Text(e,{fontFamily:"Rubik",fontSize:s,fill:"white",fontWeight:"800",align:"center"}),this.progField1.scale.set(.75,1),this.progField2=new PIXI.Text(i,{fontFamily:"Rubik",fontSize:n,fill:"white",fontWeight:"800",align:"center"}),this.progField2.scale.set(.75,1),this.prevPicCont=new Container;var a=new PIXI.Graphics;a.beginFill(16777215,1),a.drawRect(0,0,stateWidth,stateHeight),a.endFill();var o=a.generateCanvasTexture(),r=new Sprite(o);this.prevPicCont.addChild(r),this.cont.addChild(t,this.prevPicCont,this.progField1,this.progField2)}function State(){}function Preloader(){var t=this;return this.cont=new Container,this.cont.visible=!1,this.progField=null,WebFontConfig.ready(function(){t.progField=new PIXI.Text("0%",{fontSize:22,fill:"white",fontFamily:"Rubik",fontWeight:"900"}),t.progField.scale.set(.75,1),Loader.add([{name:"prelo_bg",url:"img/preloader_bg.png"},{name:"pbP_mask",url:"img/pbP_mask.png"},{name:"hG_mask",url:"img/hG_mask.png"},{name:"preloData",url:"json/dataDefault.json?rand=<?=time()?>"},{name:"hotGame",url:"json/get_games_preload_en.txt"}]).load(t.init.bind(t))}),this}function Preview(){return this.cont=new Container,this.cont.interactiveChildren=!1,this.cont.visible=!1,this}function SoundBt(){return this.cont=new Container,this.cont.visible=!1,this}function Splash(){return this.cont=new Container,this.cont.interactiveChildren=!1,this.cont.visible=!1,this}function startState(){PIXI.utils.skipHello();var t=document.getElementById("stage");app=new PIXI.Application(t.width,t.height,{view:t,antialias:!1,transparent:!0,resolution:1},!1),scaleToWindow(document.getElementById("mainContainer")),window.addEventListener("orientationchange",resizeGame,!1),window.addEventListener("resize",resizeGame,!1),preloader=new Preloader,preview=new Preview,splash=new Splash,soundBt=new SoundBt,gameUI=new GameUI,game=new Game,share=new Share,app.stage.addChild(game.cont,gameUI.cont,splash.cont,soundBt.cont,preview.cont,preloader.cont,share.cont)}function startPrev(){isvisible=!0,document.addEventListener("visibilitychange",handleVisibilityChange,!1),preview.cont.visible=!0,preloader.cont.interactiveChildren=!1,preloader.tween=PIXI.tweenManager.createTween(preloader.cont),preloader.tween.time=500,preloader.tween.to({alpha:0}),preloader.tween.start(),preloader.tween.on("end",function(){preloader&&(delete preloader.tween,preloader.cont.visible=!1,preloader.stop(),preloader=void 0),preview.play()})}function startSplash(t){splash.cont.visible=!0,splash.play(),t instanceof GameUI||t instanceof Share?(gameUI.finalStageManag(),gameUI.cont.interactiveChildren=!1,share.cont.interactiveChildren=!1,splash.tween=PIXI.tweenManager.createTween(splash.cont),splash.tween.time=500,splash.tween.to({alpha:1}),splash.tween.start(),splash.tween.on("end",function(){delete splash.tween,t.cont.visible=!1,splash.cont.interactiveChildren=!0,splash.play()})):(preview.tween=PIXI.tweenManager.createTween(preview.cont),preview.tween.time=500,preview.tween.to({alpha:0}),preview.tween.start(),preview.tween.on("end",function(){delete preview.tween,preview.cont.interactive=!1,preview.cont.visible=!1,splash.cont.interactiveChildren=!0,splash.play()}))}function startGame(){game.finalStageManag("show"),game.onStartPrepar(),game.cont.visible=!0,gameUI.cont.visible=!0,splash.cont.interactiveChildren=!1,splash.tween=PIXI.tweenManager.createTween(splash.cont),splash.tween.time=500,splash.tween.to({alpha:0}),splash.tween.start(),splash.tween.on("end",function(){splash.stop(),delete splash.tween,game.cont.interactiveChildren=!0,gameUI.cont.interactiveChildren=!0,splash.cont.visible=!1})}var adsManager,adsLoader,adDisplayContainer,intervalTimer,videoContent,abp=!1,adContainer,app,Container=PIXI.Container,Sprite=PIXI.Sprite,Loader=PIXI.loader,resources=PIXI.loader.resources,preloader,isvisible,preview,splash,soundBt,gameUI,game,share,stateWidth=700,stateHeight=525,elapsed,fullScreenDetect=!1;document.cancelFullScreen=document.cancelFullScreen||document.webkitCancelFullScreen||document.mozCancelFullScreen;var getRandomInt=function(t,e){return Math.floor(Math.random()*(e-t+1))+t};DefaultButton.prototype.onButtonHandler=function(t){switch(t.type){case"touchstart":case"mousedown":this.filter.brightness(.9,!1),t.target.filters=[this.filter],t.target.scale.x>0?t.target.scale.set(t.target.scale.x-this.relScale,t.target.scale.y-this.relScale):t.target.scale.set(-.95,.95);break;case"mouseup":case"touchend":case"mouseupoutside":case"touchendoutside":this.lastBt.filters=null,this.lastBt.scale.x>0?this.lastBt.scale.set(1,1):this.lastBt.scale.set(-1,1);break;case"mouseover":this.filter.brightness(1.1,!1),t.target.filters=[this.filter],t.target.scale.x>0?t.target.scale.set(t.target.scale.x+this.relScale,t.target.scale.y+this.relScale):t.target.scale.set(-1.05,1.05);break;case"mouseout":this.lastBt.filters=null,this.lastBt.scale.x>0?this.lastBt.scale.set(1,1):this.lastBt.scale.set(-1,1)}},extend(Game,State),Game.prototype.init=function(t){function e(){n.brush.visible?resources.stopBtIfPaint.sound.play():(resources.toFinSnd.sound.play(),gameUI.finalStageManag(),n.persMood())}function i(){n.brush.visible?resources.stopBtIfPaint.sound.play():(this.interactive=n.btOk.interactive=!1,n.plateAnimation("show"))}function s(){n.btOk.interactive=n.btTrash.interactive=!0,n.plateAnimation("hide")}var n=this,a=0;this.selectCat=function(t){n.cakeCont.visible&&(resources.selectCat.sound.play(),n.lastCat&&n.scaleBt(n.lastCat,0,1,!0),n.lastCat=t.target,n.scaleBt(t.target,5,1.4,!1),n.changeCat(t.target.name),n.btContDecor.interactiveChildren&&(n.btContDecor.filters=[n.btContDecor.darcFilter],n.btContDecor.alpha=.7,n.btContDecor.interactiveChildren=!1,n.lastDecor.filters=null,n.lastDecor=null),a+=1,n.persMood("happy_0"+a),3===a&&(a=0))},this.scaleBt=function(t,e,i,s){var a=+t.name-1,o=95+9*a,r=-(325+e)*Math.cos(Math.PI*o/180),h=-(320+e)*Math.sin(Math.PI*o/180);t.position.set(r,h),t.scale.set(i,i),n.lastCat.interactive=s,t.filters=null},this.changeCat=function(t){var e=+t-1;t=t<10?"catBg_0"+t:"catBg_"+t,n.cat.texture=PIXI.utils.TextureCache[t],n.catBg.tint="0x"+n.catColor[e],n.btContMenu.children.forEach(function(t,i,s){if(t.name){var a=i;a<10&&(a="0"+a),t.texture=PIXI.utils.TextureCache[n.catName[e]+"_"+a]}else t.visible=!1})},this.winManag=function(){n.winCont.visible?n.winCont.visible=!1:n.winCont.visible=!0;for(var t=n.cont.children.length-1,e=0;e<t;e++)n.winCont.visible?(n.cont.getChildAt(e).interactiveChildren=!1,n.lastDecor&&(n.lastDecor.filters=null,n.lastDecor=null,n.btContDecor.filters=[n.btContDecor.darcFilter],n.btContDecor.alpha=.8)):n.cont.getChildAt(e)!==n.btContDecor&&(n.cont.getChildAt(e).interactiveChildren=!0)},this.texturs=t[0],this.texturs2=t[1],this.texturs3=t[2],this.btOk=new DefaultButton(["preloData","gameUI/btns/btOk"]),this.btOk.on("click",e).on("tap",e),this.btTrash=new DefaultButton(["preloData","gameUI/btns/btTrash"]),this.btTrash.on("click",i).on("tap",i),this.plateAnimation=function(t){n.bgWinTween=PIXI.tweenManager.createTween(n.winCont.getChildAt(0)),n.bgWinTween.time=400,n.plateTween=PIXI.tweenManager.createTween(n.plateCont),n.plateTween.delay=200,n.picTween||(n.winPic.pivot.set(stateWidth/2,stateHeight/2+50),n.winPic.position.set(stateWidth/2,stateHeight/2+50),n.picTween=PIXI.tweenManager.createTween(n.winPic),n.picTween.time=800,n.picTween.pingPong=!0,n.picTween.loop=!0,n.picTween.from({scale:{x:1,y:1}}),n.picTween.to({scale:{x:.95,y:.95}})),"show"===t?(n.winManag(),resources.winSnd.sound.play(),n.winCont.interactiveChildren=!0,n.plateTween.time=800,n.plateTween.easing=PIXI.tween.Easing.outElastic(),n.winCont.getChildAt(0).alpha=0,n.bgWinTween.to({alpha:1}),n.plateCont.scale.set(.01),n.plateCont.position.set(n.btTrash.x,n.btTrash.y),n.plateTween.from({scale:{x:.01,y:.01},x:n.btTrash.x,y:n.btTrash.y}),n.plateTween.to({scale:{x:1,y:1},x:stateWidth/2,y:stateHeight/2-50}),n.picTween.start()):("hide"===t?resources.winHidSnd.sound.play():resources.clickIn.sound.play(),n.winCont.interactiveChildren=!1,n.plateTween.time=200,n.winCont.getChildAt(0).alpha=1,n.bgWinTween.to({alpha:0}),n.plateCont.scale.set(1),n.plateCont.position.set(stateWidth/2,stateHeight/2-50),n.plateTween.from({scale:{x:1,y:1},x:stateWidth/2,y:stateHeight/2-50}),n.plateTween.to({scale:{x:.01,y:.01},x:n.btTrash.x,y:n.btTrash.y}),n.picTween.stop(),n.plateTween.on("end",function(){if("clear"===t){resources.garbageSnd.sound.play(),n.cakeStartPos.x=n.cakeCont.x,n.cakeStartPos.y=n.cakeCont.y,n.twistFilter=new PIXI.filters.TwistFilter,n.twistFilter.offset=new PIXI.Point(500,300),n.cakeCont.filters=[n.twistFilter],n.decorCont.filters=[n.twistFilter];var e=PIXI.tweenManager.createTween(n.decorCont);e.time=1e3,e.from({scale:{x:1,y:1},x:0,y:0}),e.to({scale:{x:.01,y:.01},x:500,y:300}),e.start();var i=PIXI.tweenManager.createTween(n.cakeCont);i.time=1e3,i.from({scale:{x:1,y:1},x:n.cakeStartPos.x,y:n.cakeStartPos.y}),i.to({scale:{x:.01,y:.01},x:500,y:300}),i.start(),i.on("end",function(){n.winManag(),n.onStartPrepar()})}else n.winManag()})),n.bgWinTween.start(),n.plateTween.start()},this.stand=new Sprite(this.texturs2.stand),this.winCont=new Container,this.plateCont=new Container;var o=new PIXI.Graphics;o.beginFill(0,.7),o.drawRect(0,0,stateWidth,stateHeight),o.endFill(),this.winPic=new Sprite(t[1].win_pic),this.btOk_win=new DefaultButton(["preloData","gameUI/btns/btOk_win"]),this.btOk_win.on("click",function(){n.plateAnimation("clear")}).on("tap",function(){n.plateAnimation("clear")}),this.btClose=new DefaultButton(["preloData","gameUI/btns/btClose"]),this.btClose.on("click",s).on("tap",s),this.plateCont.addChild(new Sprite(t[1].win),this.winPic,this.btOk_win,this.btClose),this.plateCont.pivot.set(stateWidth/2,stateHeight/2-50),this.winCont.addChild(o,this.plateCont),this.winCont.visible=!1,this.cakeCont=new Container,this.cakeStartPos={x:410,y:115},this.cakeCont.position.set(this.cakeStartPos.x,this.cakeStartPos.y),this.decorCont=new Container,this.lastDecor=null,this.rouletteCont=new Container,this.rouletteCont.y=stateHeight,this.cat=new Sprite(t[1].catBg_01),this.cat.anchor.y=1;var r=new Sprite(this.texturs2.catLine);r.anchor=this.cat.anchor,r.scale.set(1.33,1.33);var h=293;this.catBg=new PIXI.Graphics,this.catBg.beginFill(16777215,.6),this.catBg.moveTo(0,0),this.catBg.lineTo(h,0),this.catBg.arc(h,0,h,90*Math.PI/180,Math.PI),this.catBg.pivot.set(h,0),this.catBg.rotation=-Math.PI,this.catBg.y=this.rouletteCont.y,this.btContMenu=new Container,this.btContTween=null;var l=new Sprite(this.texturs2.arrow_cat);this.arrow_prev=new DefaultButton(l,{x:l.width/2,y:-240},this.rotBtCont.bind(this)),l=new Sprite(this.texturs2.arrow_cat),this.arrow_next=new DefaultButton(l,{x:240,y:-l.width/2,rotation:90*-Math.PI/180},this.rotBtCont.bind(this)),this.btGlow=new PIXI.Graphics,this.btGlow.lineStyle(0),this.btGlow.beginFill(16777215,1),this.btGlow.drawCircle(0,0,35),this.btGlow.endFill();var c=new PIXI.filters.BlurFilter;c.blur=2,this.btGlow.filters=[c],this.btContMenu.addChild(this.btGlow),this.rouletteCont.addChild(this.cat,r,this.btContMenu,this.arrow_next,this.arrow_prev);for(var u=10,p=0;p<u;p++){var d="cat_0"+(p+1);p+1===u&&(d="cat_"+(p+1));var m=95+9*p,g=new DefaultButton(new Sprite(this.texturs3[d]),{x:-325*Math.cos(Math.PI*m/180),y:-320*Math.sin(Math.PI*m/180)},this.selectCat);g.name=p+1,this.rouletteCont.addChild(g),p>=3&&p<=9&&(g.dragEll=!0),0===p&&(this.lastCat=g,this.scaleBt(g,5,1.4,!1))}var b=5,w=4,C=15,f=240;this.startDrag=function(t){t.target.name+n.lastCat.name;n.lastCat.dragEll?(gameUI.cont.interactiveChildren=!1,soundBt.cont.interactiveChildren=!1,n.rouletteCont.interactiveChildren=!1,n.btContMenu.interactiveChildren=!1,n.btContDecor.interactiveChildren=!1,n.btOk.interactive=!1,n.btTrash.interactive=!1,t.target.filters=null,t.target.scale.set(1,1),new DecorPart("objcts/"+n.catName[+n.lastCat.name-1]+"_"+t.target.name.split("_")[1],t)):(n.selectElement(t),resources.selectBt.sound.play())};for(var p=0;p<w;p++)for(var v=0;v<b;v++){var y=v+b*p+1,d="_0"+y;y>=10&&(d="_"+y);var m=90*p+C*(v+1),P=-f*Math.cos(Math.PI*m/180),x=-f*Math.sin(Math.PI*m/180),I=new DefaultButton(new Sprite(t[2]["shape"+d]),{x:P,y:x});I.on("mousedown",this.startDrag).on("touchstart",this.startDrag),I.name="bt"+d,this.btContMenu.addChild(I)}this.btContDecor=new Container;for(var _=2,B=6,p=0;p<B;p++){var I,S=new Sprite(this.texturs2.plateForBt);this.btContDecor.addChild(S),S.position.set(stateWidth-(S.width+_)*B-7+p*(S.width+_),stateHeight-(S.height+_));var k="btn_0"+(p+1);p+1===4&&(k="btn_03"),I=new Sprite(this.texturs2[k]),I.name=p+1,p+1!==4?this.btContDecor.addChild(new DefaultButton(I,{x:S.x+_+1+I.width/2,y:S.y+_+I.height/2},this.decorControl.bind(this))):this.btContDecor.addChild(new DefaultButton(I,{x:S.x+I.width/2,y:S.y+_+I.height/2,scaleX:-1},this.decorControl.bind(this)))}this.drawMask=new PIXI.Graphics,this.brush=new Sprite(this.texturs2.print_brush),this.brush.anchor.set(.75,0),this.paintProp={totalPart:10,totalTime:450,rectWidth:0,counter:0,lastPrint:null},this.shapeMask=new Sprite(resources.shape_01.texture),this.print=new Sprite(this.texturs["objcts/pr_01"]),this.printCont=new Container,this.shape=new Sprite(this.texturs["objcts/shape_01"]),this.printCont.addChild(this.print,this.shapeMask),this.print.mask=this.shapeMask,this.cakeCont.addChild(this.shape,this.printCont,this.drawMask),this.printCont.mask=this.drawMask,this.btContDecor.darcFilter=new PIXI.filters.ColorMatrixFilter,this.btContDecor.darcFilter.brightness(.8,!1),this.particleCont=new Container,this.decorParticleCont=new Container,this.emitter=new PIXI.particles.Emitter(this.particleCont,[resources.particle.texture],resources.colorPouffe.data),this.emitter.updateOwnerPos(this.cakeCont.x+this.cakeCont.width/2,this.cakeCont.y+this.cakeCont.height/2),this.emitter.emit=!1,this.emitter2=new PIXI.particles.Emitter(this.particleCont,[resources.particle2.texture],resources.shapePouffe.data),this.emitter2.updateOwnerPos(this.cakeCont.x+this.cakeCont.width/2,this.cakeCont.y+this.cakeCont.height/2),this.emitter2.emit=!1,this.emitter3=new PIXI.particles.Emitter(this.cont,[resources.bubb_01.texture,resources.bubb_02.texture,resources.bubb_03.texture,resources.bubb_04.texture,resources.bubb_05.texture],resources.bubblesVert.data),this.emitter3.emit=!1,this.pers=new PIXI.spine.Spine(resources.fynsy.spineData),this.pers.skeleton.setSkinByName("full_face"),this.pers.position.set(275,450),this.pers.state.setAnimation(0,"idle_01",!0),this.pers.state.timeScale=0,this.table=new Container;var D=new Sprite(resources.tabletop.texture);D.y=stateHeight-D.height,this.table.addChild(D,this.stand,this.pers,this.cakeCont),this.cont.addChild(new Sprite(resources.game_bg.texture),this.table,this.catBg,this.rouletteCont,this.btContDecor,this.decorCont,this.brush,this.particleCont,this.btTrash,this.btOk,this.winCont),this.brush.position=this.cakeCont.position,this.brush.visible=!1},Game.prototype.onStartPrepar=function(){for(this.drawMask.clear(),this.paintProp.lastPrint=null,this.shape.tint="0xffffff",this.changeCat(1),this.btContMenu.interactiveChildren=!0,this.btContMenu.rotation=0*Math.PI/180;this.decorCont.children.length>0;)removeDecor(this.decorCont.getChildAt(0));this.btContMenu.children.forEach(function(t,e,i){t.name&&(t.rotation=0*Math.PI/180)}),this.scaleBt(this.lastCat,0,1,!0),this.lastCat=this.rouletteCont.getChildByName(1),this.scaleBt(this.rouletteCont.getChildByName(1),5,1.4,!1),this.btGlow.visible=!1,this.pers.state.clearListeners(),this.pers.state.timeScale=.75,this.drawPrint=null,this.catBg.tint="0x"+this.catColor[0],this.cakeCont.filters=null,this.decorCont.filters=null,this.cakeCont.position.set(this.cakeStartPos.x,this.cakeStartPos.y),this.decorCont.position.set(0,0),this.cakeCont.scale.set(1),this.decorCont.scale.set(1),this.cakeCont.visible=!1,this.btContDecor.filters=[this.btContDecor.darcFilter],this.btTrash.filters=[this.btContDecor.darcFilter],this.btOk.filters=[this.btContDecor.darcFilter],this.btContDecor.interactiveChildren=!1,this.btTrash.interactive=!1,this.btOk.interactive=!1,this.btContDecor.alpha=this.btTrash.alpha=this.btOk.alpha=.8},Game.prototype.decorControl=function(t){switch(t.target.name){case 1:this.lastDecor.scale.y<=1.4?(resources.transformDecor.sound.play(),this.lastDecor.scale.x<0?this.lastDecor.scale.x-=.1:this.lastDecor.scale.x+=.1,this.lastDecor.scale.y+=.1):resources.stopBtIfPaint.sound.play();break;case 2:this.lastDecor.scale.y>.3?(resources.transformDecor.sound.play(),this.lastDecor.scale.x>0?this.lastDecor.scale.x-=.1:this.lastDecor.scale.x+=.1,this.lastDecor.scale.y-=.1):resources.stopBtIfPaint.sound.play();break;case 3:resources.transformDecor.sound.play(),this.lastDecor.rotation-=15*Math.PI/180;break;case 4:resources.transformDecor.sound.play(),this.lastDecor.rotation+=15*Math.PI/180;break;case 5:resources.transformDecor.sound.play(),this.lastDecor.scale.x=-this.lastDecor.scale.x;break;case 6:return removeDecor(this.lastDecor),void resources.removeDecorSnd.sound.play()}this.lastDecor.y<stateHeight-(this.btContDecor.height+this.lastDecor.height/2)?(this.btContDecor.filters=null,this.btContDecor.alpha=1,this.btContDecor.interactiveChildren=!0):(this.btContDecor.filters=[this.btContDecor.darcFilter],this.btContDecor.alpha=.8,this.btContDecor.interactiveChildren=!1)},Game.prototype.rotBtCont=function(t){if(null===this.btContTween||!this.btContTween.active){resources.arrowSnd.sound.play(),this.btContTween=PIXI.tweenManager.createTween(this.btContMenu),this.btContTween.time=1e3;var e=Math.PI;0===t.target.rotation&&(e=-e);var i=game.btContMenu.rotation-90*e/180;this.btContTween.to({rotation:i}),this.btContTween.start(),this.btContMenu.children.forEach(function(t,i,s){if(t.name){var n=PIXI.tweenManager.createTween(t);n.time=1e3;var a=t.rotation+e*-270/180;n.to({rotation:a}),n.start()}})}},Game.prototype.selectElement=function(t){var e=this;switch(this.btGlow.position.set(t.target.x,t.target.y),this.btGlow.visible=!0,this.catName[+this.lastCat.name-1]){case"shape":resources.shapeSnd.sound.play(),this.cakeCont.visible||(this.cakeCont.visible=!0,this.btTrash.filters=null,this.btOk.filters=null,this.btTrash.interactive=!0,this.btOk.interactive=!0,this.btTrash.alpha=this.btOk.alpha=1),this.emitter2.emit=!0,this.emitter2.startColor=hex2rgb(this.shape.tint),this.shape.texture=PIXI.utils.TextureCache["objcts/"+this.catName[+this.lastCat.name-1]+"_"+t.target.name.split("_")[1]],this.shape.textureName=this.catName[+this.lastCat.name-1]+"_"+t.target.name.split("_")[1],this.shapeMask.texture=PIXI.utils.TextureCache[resources["shape_"+t.target.name.split("_")[1]].url];var i=this.stand._texture.trim.x+this.stand._texture.trim.width/2-this[this.catName[+this.lastCat.name-1]].width/2,s=this.stand._texture.trim.y+this.stand._texture.trim.height/1.2-(this[this.catName[+this.lastCat.name-1]].height+15);this.cakeCont.position.set(i,s);break;case"col":resources.colorSnd.sound.play(),this.emitter.emit=!0,this.emitter.startColor=hex2rgb(this.shapeColor[+t.target.name.split("_")[1]-1]),this.shape.tint="0x"+this.shapeColor[+t.target.name.split("_")[1]-1];break;case"pr":this.paintProp.lastPrint!=="objcts/pr_"+t.target.name.split("_")[1]&&(this.drawMask.clear(),this.brush.visible&&this.brush.tween.active&&(e.brush.tween.stop().reset(),clearInterval(this.drawPrint)),this.paintProp.lastPrint="objcts/pr_"+t.target.name.split("_")[1],this.print.texture=PIXI.utils.TextureCache[this.paintProp.lastPrint],this.paintProp.rectWidth=this.shape.width/this.paintProp.totalPart,this.paintProp.counter=0,this.brush.scale.y=1,this.brush.position.set(this.cakeCont.x+this.paintProp.rectWidth/2,this.cakeCont.y),this.brush.visible=!0,this.brush.tween||(this.brush.tween=PIXI.tweenManager.createTween(this.brush),this.brush.tween.time=2*this.paintProp.totalTime,this.brush.tween.pingPong=!0,this.brush.tween.loop=!0,this.brush.tween.to({y:this.cakeCont.y+this.cakeCont.height})),this.brush.tween.start(),this.drawPrint=setInterval(function(){resources.paintSnd.sound.play(),e.drawMask.beginFill(16777215,1),e.drawMask.drawRect(e.paintProp.rectWidth*e.paintProp.counter,0,e.paintProp.rectWidth,350),e.drawMask.endFill(),e.brush.x+=e.paintProp.rectWidth,e.brush.scale.y=-e.brush.scale.y,e.paintProp.counter+=1,e.paintProp.counter===e.paintProp.totalPart&&(e.brush.visible=!1,e.brush.tween.stop().reset(),clearInterval(e.drawPrint))},this.paintProp.totalTime))}},Game.prototype.finalStageManag=function(t){"hide"===t?(this.lastDecor&&(this.lastDecor.filters=null,this.lastDecor=null,this.btContDecor.filters=[this.btContDecor.darcFilter],this.btContDecor.alpha=.8,this.btContDecor.interactiveChildren=!1),this.cont.interactiveChildren=!1,this.objTween(this.catBg,{x:-stateWidth/2}),this.objTween(this.rouletteCont,{x:-stateWidth/2}),this.objTween(this.btContDecor,{y:1.05*this.btContDecor.height}),this.objTween(this.cont.getChildAt(0),{x:stateWidth-this.cont.getChildAt(0).width}),this.objTween(this.table,{x:stateWidth-this.table.getChildAt(0).width}),this.objTween(this.decorCont,{x:stateWidth-this.table.getChildAt(0).width})):(this.winCont.visible=!0,this.winManag(),this.cont.interactiveChildren=!0,this.catBg.x=this.rouletteCont.x=-stateWidth/2,this.btContDecor.y=1.05*this.btContDecor.height,this.cont.getChildAt(0).x=stateWidth-this.cont.getChildAt(0).width,this.table.x=this.decorCont.x=stateWidth-this.table.getChildAt(0).width,this.objTween(this.catBg,{x:.1}),this.objTween(this.rouletteCont,{x:.1}),this.objTween(this.btContDecor,{y:.1}),this.objTween(this.cont.getChildAt(0),{x:.1}),this.objTween(this.table,{x:.1}),this.objTween(this.decorCont,{x:.1}),this.pers.state.clearListeners(),this.pers.state.timeScale=.75,this.pers.state.setAnimation(0,"idle_01",!0))},Game.prototype.objTween=function(t,e){t.t&&delete t.t,t.t=PIXI.tweenManager.createTween(t),t.t.time=1e3,e.x&&t.t.to({x:e.x}),e.y&&t.t.to({y:e.y}),t.t.start()},Game.prototype.persMood=function(t){var e=this;this.pers.state.clearListeners(),t?(this.countVoice+=1,this.countVoice>=6&&(e.countVoice=1),this.voice=resources["persVoice_0"+e.countVoice].sound.play(),this.pers.state.setAnimation(0,t,!0),this.pers.state.addListener({complete:function(t,i){e.pers.state.setAnimation(0,"idle_01",!0)}})):(this.pers.state.timeScale=1.5,this.pers.state.addListener({complete:function(t,i){if(e.pers.state.clearListeners(),"0xffffff"!==e.shape.tint&&e.paintProp.lastPrint&&e.decorCont.children.length>=3){e.pers.state.timeScale=.75,resources.happyFinal.sound.play(),e.emitter3.emit=!0,e.pers.state.setAnimation(0,"idle_02",!0),e.emitter3.frequency=.07,e.emitter3.maxParticles=100;var s=setTimeout(function(){e.countVoice+=1,e.countVoice>=3&&(e.countVoice=1),resources["finalVoice_0"+e.countVoice].sound.play(),clearTimeout(s),e.emitter3.frequency=.5,e.emitter3.maxParticles=10},1e3)}else e.pers.state.timeScale=.5,e.pers.state.setAnimation(0,"sad_01",!0),e.countVoice+=1,e.countVoice>=3&&(e.countVoice=1),resources["sadVoice_0"+e.countVoice].sound.play()}}))},extend(GameUI,State),GameUI.prototype.init=function(){function t(){resources.clickIn.sound.play(),startSplash(i)}var e="horiz",i=this;this.b=new PIXI.filters.BlurFilter,this.animLogo=new PIXI.spine.Spine(resources.fynsyLogo.spineData),this.animLogo.state.timeScale=.75,this.animLogo.state.setAnimation(0,"animation",!0),this.animLogo.position.set(.65*this.animLogo.width,.8*this.animLogo.height),this.animLogo.interactive=!0,this.animLogo.buttonMode=!0,this.animLogo.name="in_game_logo";var s=new PIXI.Graphics;s.beginFill(16777215,1),s.drawCircle(0,0,this.animLogo.width/2),s.endFill(),s.x=this.animLogo.x,s.y=this.animLogo.y-this.animLogo.width/4,s.visible=!1,this.animLogoHandler=function(t){switch(t.type){case"touchstart":case"mousedown":i.animLogo.scale.set(.97,.97);break;case"mouseup":case"touchend":case"mouseupoutside":case"touchendoutside":i.animLogo.scale.set(1,1);break;case"mouseover":i.animLogo.scale.set(1.03,1.03),14!==i.b.blur&&(i.b.blur=14,s.filters=[i.b]),s.visible=!0;break;case"mouseout":s.visible=!1,i.animLogo.scale.set(1,1)}};var n=PIXI.utils.isMobile;n.phone||n.tablet?this.animLogo.on("tap",this.getMoreGame.bind(this)):this.animLogo.on("click",this.getMoreGame.bind(this)).on("mousedown",this.animLogoHandler).on("touchstart",this.animLogoHandler).on("mouseup",this.animLogoHandler).on("touchend",this.animLogoHandler).on("mouseupoutside",this.animLogoHandler).on("touchendoutside",this.animLogoHandler).on("mouseover",this.animLogoHandler).on("mouseout",this.animLogoHandler),this.btPlay_more=new DefaultButton(["preloData","gameUI/btns/btPlay_more"]),this.btPlay_more.name="splash_more_games",this.btPlay_more.on("click",this.getMoreGame.bind(this)).on("tap",this.getMoreGame.bind(this)),this.btNext=new DefaultButton(["preloData","gameUI/btns/btNext"]),this.btNext.visible=!1,this.btNext.on("click",this.finalStageManag.bind(this)).on("tap",this.finalStageManag.bind(this)),this.btReplay=new DefaultButton(["preloData","gameUI/btns/btReplay"]),this.btReplay.visible=!1,this.btReplay.on("click",t).on("tap",t),this.btShare=new DefaultButton(["preloData","gameUI/btns/btShare"]),this.btShare.visible=!1,this.btShare.on("click",this.createShare.bind(this)).on("tap",this.createShare.bind(this)),this.createHot(2,e),this.hotCont.scale.set(.8,.8),"upright"===e?this.hotCont.position.set(stateWidth-this.hotCont.width/1.8,stateHeight/2):this.hotCont.position.set(stateWidth/2,stateHeight-this.hotCont.height/2);var a=this.hotCont.scale.x;this.hotCont.t=PIXI.tweenManager.createTween(this.hotCont),this.hotCont.t.time=1e3,this.hotCont.t.pingPong=!0,this.hotCont.t.loop=!0,this.hotCont.t.from({scale:{x:a,y:a}}),this.hotCont.t.to({scale:{x:a+.05,y:a+.05}}),this.cont.addChild(s,this.animLogo,this.btPlay_more,this.btNext,this.btReplay,this.btShare)},GameUI.prototype.createShare=function(t){resources.photo.sound.play(),share.show(),this.cont.interactiveChildren=!1,soundBt.cont.interactiveChildren=!1,game.cont.interactiveChildren=!1,4!==this.b&&(this.b.blur=4),this.cont.filters=[this.b],soundBt.cont.filters=[this.b],game.cont.filters=[this.b];
},GameUI.prototype.finalStageManag=function(){game.emitter3.emit=!1,this.btNext.scale.x>0?(resources.clickIn.sound.play(),game.winCont.visible=!1,game.btOk.visible=!1,game.btTrash.visible=!1,game.finalStageManag("hide"),this.btNext.scale.x=-1,this.btNext.visible=!0,this.btShare.visible=!0,this.btReplay.visible=!0,this.hotCont.visible=!0,this.hotCont.t.start(),this.hotCont_01.getChildAt(0).t.start(),this.hotCont_02.getChildAt(0).t.start()):(game.btOk.visible=!0,game.btTrash.visible=!0,splash.cont.visible?resources.clickIn.sound.play():(game.finalStageManag("show"),resources.backGameSnd.sound.play()),this.btNext.visible=!1,this.btNext.scale.x=1,this.btShare.visible=!1,this.btReplay.visible=!1,this.hotCont.visible=!1,this.hotCont.t.stop(),this.hotCont_01.getChildAt(0).t.stop(),this.hotCont_02.getChildAt(0).t.stop())},extend(Share,State),Share.prototype.init=function(){function t(){resources.clickOut.sound.play();var t="http://fynsy."+l+"/?utm_source=facebook%26utm_medium=share_link";return this.href="https://www.facebook.com/sharer/sharer.php?s=100%20&p[title]="+h+"&p[url]="+t,window.open(this.href,"Опубликовать ссылку в Facebook","width=640,height=436,toolbar=0,status=0"),!1}function e(){resources.clickOut.sound.play();var t="http://fynsy."+l+"/?utm_source=google%26utm_medium=share_link";this.href="https://plus.google.com/share?url="+t,window.open(this.href,"Опубликовать ссылку","width=640,height=436,toolbar=0,status=0")}function i(){resources.clickOut.sound.play();var t="http://fynsy."+l+"/?utm_source=twitter%26utm_medium=share_link";this.href="https://twitter.com/intent/tweet?text="+h+"&url="+t,window.open(this.href,"Опубликовать ссылку","width=640,height=436,toolbar=0,status=0")}function s(){resources.clickIn.sound.play();var t=document.createElement("a"),e=a.dataUrl.replace(/^data:image\/png/,"data:application/octet-stream");t.setAttribute("href",e),t.setAttribute("download",document.title+".png"),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)}function n(){a.closeShare(),startSplash(a)}var a=this;this.closeShare=function(){resources.clickIn.sound.play(),this.cont.interactiveChildren=!1,this.shareTween=PIXI.tweenManager.createTween(this.cont),this.shareTween.time=200,this.shareTween.to({alpha:0}),this.shareTween.start(),this.shareTween.on("end",function(){a.cont.visible=!1,a.cont.alpha=1,gameUI.cont.interactiveChildren=!0,soundBt.cont.interactiveChildren=!0,gameUI.cont.filters=null,soundBt.cont.filters=null,game.cont.filters=null,a.prevPicCont.cacheAsBitmap=!1,a.prevPicCont.rotation=0*Math.PI/180,a.prevPicCont.scale.set(1),a.prevPicCont.position.set(0,0)})},this.btClose=new DefaultButton(["preloData","share/btns/btClose"]),this.btClose.on("click",this.closeShare.bind(this)).on("tap",this.closeShare.bind(this)),this.btFb=new DefaultButton(["preloData","share/btns/btFb"]),this.btGoo=new DefaultButton(["preloData","share/btns/btGoo"]),this.btTw=new DefaultButton(["preloData","share/btns/btTw"]),this.btSave=new DefaultButton(["preloData","share/btns/btSave"]),this.btReplay=new DefaultButton(["preloData","share/btns/btReplay"]);var o=new PIXI.BaseRenderTexture(stateWidth,stateHeight,PIXI.SCALE_MODES.LINEAR,1);this.rt=new PIXI.RenderTexture(o);var r=new PIXI.Sprite(this.rt);r.scale.set(.97,.96),r.position.set((stateWidth-r.width)/2,(stateHeight-r.height)/2),this.logoShare=new Sprite(resources.preloData.textures["splash/btns/logoS_"+gameUI.determLang()]),this.logoShare.position.set(r.x,stateHeight-((stateHeight-r.height)/2+this.logoShare._texture.trim.height)),this.prevPicCont.addChild(r,this.logoShare),this.cont.addChild(this.btClose,this.btFb,this.btGoo,this.btTw,this.btSave,this.btReplay),this.progField1.position.set(this.btGoo._texture.trim.x-(this.progField1.width/2-this.btGoo._texture.trim.width/2),this.btGoo._texture.trim.y-(this.progField1.height/2+this.btGoo._texture.trim.height/2)),this.progField2.position.set(this.btGoo._texture.trim.x-(this.progField2.width/2-this.btGoo._texture.trim.width/2),this.btSave._texture.trim.y-(this.progField2.height/2+this.btSave._texture.trim.height/2));var h="Look what a game! %23Fynsy %23FynsyGames",l="com";"ru"===gameUI.determLang()&&(l="ru"),this.btFb.on("click",t).on("tap",t),this.btGoo.on("click",e).on("tap",e),this.btTw.on("click",i).on("tap",i),this.btSave.on("click",s).on("tap",s),this.btReplay.on("click",n).on("tap",n)},Share.prototype.show=function(){app.renderer.render(game.cont,this.rt);var t=new PIXI.BaseRenderTexture(stateWidth,stateHeight,PIXI.SCALE_MODES.LINEAR,1),e=new PIXI.RenderTexture(t);app.renderer.render(this.prevPicCont,e);var i=app.renderer.extract.canvas(e);this.dataUrl=i.toDataURL("image/png",1),this.prevPicCont.rotation=5*-Math.PI/180,this.prevPicCont.scale.set(.6),this.prevPicCont.position.set(12,120),this.prevPicCont.cacheAsBitmap=!0,this.cont.visible=!0,this.cont.interactiveChildren=!0},State.prototype.getManifest=function(){var t=[{name:"preview",url:"json/skeleton.json"},{name:"prev_bg",url:"img/preview_bg_"+this.determLang()+".png"},{name:"tabletop",url:"img/tabletop.jpg"},{name:"game_bg",url:"img/game_bg.jpg"},{name:"beam",url:"img/beam.png"},{name:"splash_bg",url:"img/splash_bg.jpg"},{name:"fynsyLogo",url:"json/head_logo_small_new_fynsy.json"},{name:"bg",url:"img/game_bg.jpg"},{name:"dataGame",url:"json/dataGame.json?rand=<?=time()?>"},{name:"dataGame2",url:"json/dataGame2.json?rand=<?=time()?>"},{name:"dataGame3",url:"json/dataGame3.json?rand=<?=time()?>"},{name:"shape_01",url:"img/shape_01.png"},{name:"shape_02",url:"img/shape_02.png"},{name:"shape_03",url:"img/shape_03.png"},{name:"shape_04",url:"img/shape_04.png"},{name:"shape_05",url:"img/shape_05.png"},{name:"shape_06",url:"img/shape_06.png"},{name:"shape_07",url:"img/shape_07.png"},{name:"shape_08",url:"img/shape_08.png"},{name:"shape_09",url:"img/shape_09.png"},{name:"shape_10",url:"img/shape_10.png"},{name:"shape_11",url:"img/shape_11.png"},{name:"shape_12",url:"img/shape_12.png"},{name:"shape_13",url:"img/shape_13.png"},{name:"shape_14",url:"img/shape_14.png"},{name:"shape_15",url:"img/shape_15.png"},{name:"shape_16",url:"img/shape_16.png"},{name:"shape_17",url:"img/shape_17.png"},{name:"shape_18",url:"img/shape_18.png"},{name:"shape_19",url:"img/shape_19.png"},{name:"shape_20",url:"img/shape_20.png"},{name:"particle",url:"img/particle.png"},{name:"particle2",url:"img/CartoonSmoke.png"},{name:"bubb_01",url:"img/bubb_01.png"},{name:"bubb_02",url:"img/bubb_02.png"},{name:"bubb_03",url:"img/bubb_03.png"},{name:"bubb_04",url:"img/bubb_04.png"},{name:"bubb_05",url:"img/bubb_05.png"},{name:"colorPouffe",url:"json/emitter1.json"},{name:"shapePouffe",url:"json/emitter2.json"},{name:"bubblesVert",url:"json/emitter3.json"},{name:"fynsy",url:"json/Fynsy_main.json"},{name:"bgMusic",url:"sound/bgMusic.mp3"},{name:"clickOut",url:"sound/click1.mp3"},{name:"clickIn",url:"sound/click2.mp3"},{name:"prevFynsyVoice",url:"sound/prevFynsyVoice.mp3"},{name:"photo",url:"sound/photo.mp3"},{name:"stopBtIfPaint",url:"sound/KeyPress.mp3"},{name:"paintSnd",url:"sound/swap.mp3"},{name:"colorSnd",url:"sound/force1.mp3"},{name:"garbageSnd",url:"sound/garbage.mp3"},{name:"selectCat",url:"sound/down.mp3"},{name:"winSnd",url:"sound/soundBack.mp3"},{name:"backGameSnd",url:"sound/replay.mp3"},{name:"toFinSnd",url:"sound/toFin.mp3"},{name:"winHidSnd",url:"sound/1_Click.mp3"},{name:"shapeSnd",url:"sound/air-shot.mp3"},{name:"removeDecorSnd",url:"sound/needles.mp3"},{name:"selectDecor",url:"sound/minisht1.mp3"},{name:"happyFinal",url:"sound/flowers.mp3"},{name:"putDecor",url:"sound/skaki.mp3"},{name:"transformDecor",url:"sound/takeScr.mp3"},{name:"arrowSnd",url:"sound/SelectTrack.mp3"},{name:"selectBt",url:"sound/Plopp.mp3"},{name:"finalVoice_01",url:"sound/s-55.mp3?rand=<?=time()?>"},{name:"finalVoice_02",url:"sound/s-56.mp3?rand=<?=time()?>"},{name:"sadVoice_01",url:"sound/s-60.mp3?rand=<?=time()?>"},{name:"sadVoice_02",url:"sound/s-70.mp3?rand=<?=time()?>"},{name:"persVoice_01",url:"sound/s-24.mp3?rand=<?=time()?>"},{name:"persVoice_02",url:"sound/s-39.mp3?rand=<?=time()?>"},{name:"persVoice_03",url:"sound/s-58.mp3?rand=<?=time()?>"},{name:"persVoice_04",url:"sound/s-71.mp3?rand=<?=time()?>"},{name:"persVoice_05",url:"sound/s-73.mp3?rand=<?=time()?>"}];return t},State.prototype.determLang=function(){var t="en";return t},State.prototype.getMoreGame=function(t){resources.clickOut.sound.play();var e="ru";e!==this.determLang()&&(e="com");var i="http://fynsy."+e+"/?utm_source="+location.hostname+"&utm_medium="+t.target.name+"&utm_campaign="+document.title;return window.open(i),!1},State.prototype.getHotGame=function(t){if(this instanceof Preloader)this.urlArray.length>3?window.open(this.urlArray[2*t-1][1]):window.open("http://www.fynsy.ru/game/"+this.urlArray[t-1][1]);else{var e=resources["tit_hot"+t].url.split("/"),i=e[e.length-1].split(".");"ru"===this.determLang()?window.open("http://www.fynsy.ru/game/"+i[0]):window.open("http://www.fynsy.com/game/"+i[0])}return!1},window.WebFontConfig={google:{families:["Rubik:900&amp;subset=cyrillic"]},listeners:[],active:function(){this.called_ready=!0;for(var t=0;t<this.listeners.length;t++)this.listeners[t]()},ready:function(t){this.called_ready?t():this.listeners.push(t)}},extend(Preloader,State),State.prototype.createHot=function(t,e){this.roundRect=function(t,e){var i=new PIXI.Graphics;return i.lineStyle(2,16777215),i.drawRoundedRect(0,0,t,e,14),i.endFill(),i},this.circle=function(t,i,s){var n=new PIXI.Graphics;return n.beginFill(16777215),n.drawCircle(0,0,1.3*t),n.endFill(),n.position.set(i,s),n.f=new PIXI.filters.BlurFilter,n.f.blur=20,n.filters=[n.f],n.t=PIXI.tweenManager.createTween(n),n.t.time=1e3,n.t.pingPong=!0,n.t.loop=!0,n.t.from({scale:{x:.8,y:.8}}),n.t.to({scale:{x:1.2,y:1.2}}),e||n.t.start(),n},this.init=function(t){this["hotCont_0"+(t+1)]=new Container;var i=new Sprite(resources.hG_mask.texture),s="tit_hot"+(t+1);"en"===this.determLang()&&this instanceof Preloader&&(s="game"+(t+1)+"_img");var n=new Sprite(resources[s].texture),a=new Sprite(resources.preloData.textures["preloader/icon/iconS_"+this.determLang()]);a.position.set(3,i.height-(a.height+3)),this["hotCont_0"+(t+1)].hitArea=new PIXI.Rectangle(0,0,i.width,i.height),this["hotCont_0"+(t+1)].pivot.set(i.width/2,i.height/2),e?"horiz"===e?0===t?this["hotCont_0"+(t+1)].position.set(-(i.width/2+10),0):this["hotCont_0"+(t+1)].position.set(i.width/2+10,0):0===t?this["hotCont_0"+(t+1)].position.set(0,-(i.height/2+10)):this["hotCont_0"+(t+1)].position.set(0,i.height/2+10):this["hotCont_0"+(t+1)].position.set(38+i.width/2+(i.width+45)*t,20+i.height/2),this["hotCont_0"+(t+1)].addChild(this.circle(i.height/2,i.width/2,i.height/2),n,i,this.roundRect(i.width,i.height),a),n.mask=i,this instanceof Preloader?this.cont.addChild(this["hotCont_0"+(t+1)]):this.hotCont.addChild(this["hotCont_0"+(t+1)]),this["hotCont_0"+(t+1)].filter=new PIXI.filters.ColorMatrixFilter,this["hotCont_0"+(t+1)].buttonMode=!0,this["hotCont_0"+(t+1)].interactive=!0,this["hotCont_0"+(t+1)].name="hotGame_"+(t+1);var o=PIXI.utils.isMobile;o.phone||o.tablet?this["hotCont_0"+(t+1)].on("tap",this.onBtPlayContHandler.bind(this)):this["hotCont_0"+(t+1)].on("click",this.onBtPlayContHandler.bind(this)).on("mouseup",this.onBtPlayContHandler.bind(this)).on("touchend",this.onBtPlayContHandler.bind(this)).on("mouseupoutside",this.onBtPlayContHandler.bind(this)).on("touchendoutside",this.onBtPlayContHandler.bind(this)).on("mouseover",this.onBtPlayContHandler.bind(this)).on("mouseout",this.onBtPlayContHandler.bind(this))};for(var i=0;i<t;i++)this.init(i)},Preloader.prototype.init=function(){var t=this;this.btPlayCont=new Container,this.pbG=new Sprite(resources.preloData.textures["preloader/pbG"]),this.pbP=new Sprite(resources.preloData.textures["preloader/btns/pbP"]),this.pbP_mask=new Sprite(resources.pbP_mask.texture),this.logoB=new DefaultButton(["preloData","preloader/btns/logoB_"+this.determLang()]),this.logoB.on("tap",this.getMoreGame.bind(this)).on("click",this.getMoreGame.bind(this)),this.logoB.name="in_game_logo",this.btMG=new DefaultButton(["preloData","preloader/btns/btMG_"+this.determLang()]),this.btMG.on("tap",this.getMoreGame.bind(this)).on("click",this.getMoreGame.bind(this)),this.btMG.name="splash_more_games",this.pbP.anchor.set(.5,.5),this.pbP.position.set(this.pbG.texture.trim.x+this.pbG.texture.trim.width/2,this.pbG.texture.trim.y+this.pbG.texture.trim.height/2),this.pbP_mask.anchor=this.pbP.anchor,this.pbP_mask.position=this.pbP.position,this.progField.position.set(this.pbG.texture.trim.x+(this.pbG.texture.trim.width/2-this.progField.width/2),this.pbG.texture.trim.y+2),this.pbP.x-=this.pbP.texture.width,this.pbP.mask=this.pbP_mask,this.btPlayCont.addChild(this.pbG,this.pbP,this.pbP_mask,this.progField),this.btPlayCont.pivot.set(this.pbG.texture.trim.x+this.pbG.texture.trim.width/2,this.pbG.texture.trim.y+this.pbG.texture.trim.height/2),this.btPlayCont.position=this.btPlayCont.pivot,this.cont.addChild(new Sprite(resources.prelo_bg.texture),this.btPlayCont,this.btMG,this.logoB),this.urlArray=resources.hotGame.data.split("&");for(var e=[],i=this.urlArray.length,s=0;s<i;s++)if(this.urlArray[s]=this.urlArray[s].split("="),i>3){if(s%2===0&&s<6){var n=this.urlArray[s][1].split("/");e.push({name:this.urlArray[s][0],url:"img/"+n[n.length-1],crossOrigin:!1})}s>=6&&e.push({name:this.urlArray[s][0],url:"img/"+this.urlArray[s][1]+".jpg"})}else e.push({name:this.urlArray[s][0],url:"http://files.fynsy.ru/pictures/"+this.urlArray[s][1]+".jpg",crossOrigin:!0,anonymous:!0});Loader.add(e).load(function(){t.createHot(3),elapsed=Date.now(),app.ticker.add(function(){PIXI.tweenManager.update();var t=Date.now();game.emitter&&game.emitter.update(.001*(t-elapsed)),game.emitter2&&game.emitter2.update(.001*(t-elapsed)),game.twistFilter&&(game.twistFilter.angle+=1,game.twistFilter.angle>=20&&delete game.twistFilter),game.emitter3&&game.emitter3.update(.001*(t-elapsed)),elapsed=t}),t.cont.visible=!0,document.getElementById("preloAnim").style.display="none",t.startLoad()})},Preloader.prototype.startLoad=function(){function t(t,e){n=Math.floor(t.progress-100),i.pbP.x=i.pbP.width*n/100+a,i.progField.text=n+"%",i.progField.position.set(i.pbG.texture.trim.x+(i.pbG.texture.trim.width/2-i.progField.width/2),i.pbG.texture.trim.y+2)}function e(){share.init(),game.init([resources.dataGame.textures,resources.dataGame2.textures,resources.dataGame3.textures]),gameUI.init(),splash.init(),soundBt.init(),preview.init(),i.pbP.x=i.pbP.width+a;var t="ИГРАТЬ";"ru"!==i.determLang()&&(t="PLAY"),i.progField.text=t,i.progField.position.set(i.pbG.texture.trim.x+(i.pbG.texture.trim.width/2-i.progField.width/2),i.pbG.texture.trim.y+2),i.btPlayCont.hitArea=new PIXI.Rectangle(i.btPlayCont.x-i.pbG.texture.trim.width/2,i.btPlayCont.y-i.pbG.texture.trim.height/2,i.pbG.texture.trim.width,i.pbG.texture.trim.height),i.btPlayCont.interactive=!0,i.btPlayCont.buttonMode=!0,i.btPlayCont.filter=new PIXI.filters.ColorMatrixFilter,i.btPlayCont;var e=PIXI.utils.isMobile;e.phone||e.tablet?i.btPlayCont.on("tap",i.onBtPlayContHandler.bind(i)):i.btPlayCont.on("click",i.onBtPlayContHandler.bind(i)).on("mouseup",i.onBtPlayContHandler.bind(i)).on("touchend",i.onBtPlayContHandler.bind(i)).on("mouseupoutside",i.onBtPlayContHandler.bind(i)).on("touchendoutside",i.onBtPlayContHandler.bind(i)).on("mouseover",i.onBtPlayContHandler.bind(i)).on("mouseout",i.onBtPlayContHandler.bind(i))}var i=this,s=this.getManifest(),n=null,a=this.pbP.x;Loader.add(s).on("progress",t).load(e)},Preloader.prototype.stop=function(){this.hotCont_01.getChildAt(0).t.stop(),this.hotCont_02.getChildAt(0).t.stop(),this.hotCont_03.getChildAt(0).t.stop(),app.stage.removeChild(this.cont)},State.prototype.onBtPlayContHandler=function(t){function e(t){clearTimeout(i),t.filters=null,t.scale.set(1,1)}switch(t.type){case"mouseup":case"touchend":case"mouseupoutside":case"touchendoutside":this.lastBt.filters=null,this.lastBt.scale.set(1,1);break;case"mouseover":t.target.filter.brightness(1.15,!1),t.target.filters=[t.target.filter],t.target.scale.set(1.03,1.03),"t"in t.target.getChildAt(0)&&(t.target.getChildAt(0).visible=!1),this.lastBt=t.target;break;case"mouseout":this.lastBt.scale.set(1,1),this.lastBt.filters=null,"t"in this.lastBt.getChildAt(0)&&(this.lastBt.getChildAt(0).visible=!0);break;case"tap":case"click":if(t.target.filter.brightness(.8,!1),t.target.filters=[t.target.filter],t.target.scale.set(.97,.97),this.lastBt=t.target,t.target.name&&"hotGame"===t.target.name.split("_")[0]){if(resources.clickOut.sound.play(),this.getHotGame(+t.target.name.split("_")[1]),PIXI.utils.isMobile.phone||PIXI.utils.isMobile.tablet)var i=setTimeout(e(t.target),100)}else resources.clickIn.sound.play(),startPrev()}},extend(Preview,State),Preview.prototype.init=function(){this.cont.name="in_game_logo",this.beam=new Sprite(resources.beam.texture),this.beam.anchor.set(.5,.5),this.beam.position.set(stateWidth/2,stateHeight/2),this.logo=new PIXI.spine.Spine(resources.preview.spineData),this.logo.position.set(stateWidth/2,stateHeight/2+65),this.logo.state.setAnimation(0,"animation",!1);var t="ru";t!==this.determLang()&&(t="com"),this.logo.skeleton.setAttachment("com2",t),this.logo.state.timeScale=0,this.cont.addChild(new Sprite(resources.prev_bg.texture),this.beam,this.logo),this.beam.t=PIXI.tweenManager.createTween(this.beam),this.beam.t.from({rotation:0}),this.beam.t.to({rotation:359*PIXI.DEG_TO_RAD}),this.beam.t.time=5e3,this.beam.t.loop=!0,this.cont.interactive=!0,this.cont.on("click",this.getMoreGame.bind(this)).on("tap",this.getMoreGame.bind(this))},Preview.prototype.play=function(){this.cont.interactiveChildren=!0,this.beam.t.start(),this.logo.state.timeScale=1,this.logo.state.tracks[0].listener={complete:function(t,e){const i=resources.prevFynsyVoice.sound.play();i.on("end",function(){soundBt.bgSound.play({loop:!0}),soundBt.cont.visible=!0,startSplash()})}}},SoundBt.prototype.init=function(){function t(t){"mouseover"===t.type&&(this.iconPlate.visible=!0,this.iconBagBearer.visible=!0,this.cont.hitArea=new PIXI.Rectangle(this.iconPlate.texture.trim.x,this.iconPlate.texture.trim.y,stateWidth-this.iconPlate.texture.trim.x,this.iconPlate.texture.trim.height)),"mouseout"===t.type&&(this.iconPlate.visible=!1,this.iconBagBearer.visible=!1,this.cont.hitArea=null,this.iconBagBearer.dragging=!1,this.iconBagBearer.alpha=1)}function e(t){this.data=t.data,this.alpha=.75,this.dragging=!0}function i(t){this.alpha=1,this.dragging=!1,this.data=null}function s(t){if(this.dragging){var e=this.data.getLocalPosition(this.parent);this.x=e.x,this.x<this.texture.trim.x+this.texture.trim.width/2&&(this.x=this.texture.trim.x+this.texture.trim.width/2),this.x>this.texture.trim.x+this.texture.trim.width/2+n.dist&&(this.x=this.texture.trim.x+this.texture.trim.width/2+n.dist),n.bgSound.volume=1-(this.x-(this.texture.trim.x+this.texture.trim.width/2))/n.dist}}var n=this;this.dist=60,this.iconON=new DefaultButton(["preloData","soundBt/btns/sound_on"]),this.iconOFF=new DefaultButton(["preloData","soundBt/btns/sound_off"]),this.iconPlate=new Sprite(resources.preloData.textures["soundBt/btns/sound_plate"]),this.iconBagBearer=new Sprite(resources.preloData.textures["soundBt/btns/sound_bag"]),this.bgSound=resources.bgMusic.sound,this.iconOFF.visible=!1,this.cont.interactive=!0,this.iconBagBearer.interactive=!0,this.iconBagBearer.buttonMode=!0,this.iconBagBearer.hitArea=new PIXI.Circle(this.iconBagBearer.texture.trim.x+this.iconBagBearer.texture.trim.width/2,this.iconBagBearer.texture.trim.y+this.iconBagBearer.texture.trim.height/2,this.iconBagBearer.texture.trim.width/2),setPivotPoint(this.iconBagBearer),this.bgSound.volume=.5,this.iconBagBearer.x+=this.dist/2;var a=PIXI.utils.isMobile;a.phone||a.tablet?this.cont.on("tap",this.soundOn_Off.bind(this)):(this.iconON.on("click",this.soundOn_Off.bind(this)),this.iconOFF.on("click",this.soundOn_Off.bind(this)),this.cont.on("mouseover",t.bind(this)).on("mouseout",t.bind(this)),this.iconBagBearer.on("mousedown",e).on("mouseup",i).on("mouseupoutside",i).on("mousemove",s)),this.cont.addChild(this.iconPlate,this.iconON,this.iconOFF,this.iconBagBearer),this.iconPlate.visible=!1,this.iconBagBearer.visible=!1},SoundBt.prototype.soundOn_Off=function(){resources.clickIn.sound.play(),this.iconON.visible===!0?(this.cont.interactive=!1,this.iconPlate.visible=!1,this.iconBagBearer.visible=!1,this.iconON.visible=!1,this.iconOFF.visible=!0,PIXI.sound.muteAll(),isvisible=!1):(this.cont.interactive=!0,this.iconPlate.visible=!0,this.iconBagBearer.visible=!0,this.iconON.visible=!0,this.iconOFF.visible=!1,PIXI.sound.unmuteAll(),isvisible=!0)},extend(Splash,State),Splash.prototype.init=function(){function t(){resources.clickIn.sound.play(),startGame()}var e=new DefaultButton(["preloData","splash/btns/logoS_"+this.determLang()]);e.on("click",this.getMoreGame.bind(this)).on("tap",this.getMoreGame.bind(this)),e.name="in_game_logo";var i=new DefaultButton(["preloData","splash/btns/play_more"]);i.on("click",this.getMoreGame.bind(this)).on("tap",this.getMoreGame.bind(this)),i.name="splash_more_games";var s=new DefaultButton(["preloData","splash/btns/play_game"]);s.on("click",t).on("tap",t),this.pers=new PIXI.spine.Spine(resources.fynsy.spineData),this.pers.skeleton.setSkinByName("full_face"),this.pers.position.set(this.pers.width/2-10,450),this.pers.state.setAnimation(0,"splash",!0),this.pers.state.timeScale=0,this.tit=new Sprite(resources.dataGame2.textures["name_"+this.determLang()]),this.cont.addChild(new Sprite(resources.splash_bg.texture),this.pers,this.tit,e,i,s),this.tit.t=PIXI.tweenManager.createTween(this.tit),this.tit.t.time=1750,this.tit.t.loop=!0,this.tit.t.pingPong=!0,this.tit.t.from({scale:{x:1,y:1}}),this.tit.t.to({scale:{x:1.03,y:1.03}})},Splash.prototype.play=function(){this.tit.t.start(),this.pers.state.timeScale=1},Splash.prototype.stop=function(){this.tit.t.stop(),this.pers.state.timeScale=0},window.onload=function(){var t=appendScript("://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js");t.onload=function(){startState()}};